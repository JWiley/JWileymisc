<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Return a non-missing correlation matrix — corOK • JWileymisc</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->
<link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/flatly/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous" />


<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Return a non-missing correlation matrix — corOK" />
<meta property="og:description" content="Given a square, symmetric matrix (such as a correlation matrix)
this function tries to drop the fewest possible number of variables
to return a (square, symmetric) matrix with no missing cells." />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">JWileymisc</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">1.1.2</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/diagnostics-vignette.html">Diagnostics</a>
    </li>
    <li>
      <a href="../articles/exploratory-vignette.html">Exploratory and Descriptive Statistics and Plots</a>
    </li>
    <li>
      <a href="../articles/model-test-vignette.html">Model Performance and Tests</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/JWiley/JWileymisc/">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Return a non-missing correlation matrix</h1>
    <small class="dont-index">Source: <a href='https://github.com/JWiley/JWileymisc/blob/master/R/utils.R'><code>R/utils.R</code></a></small>
    <div class="hidden name"><code>corOK.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Given a square, symmetric matrix (such as a correlation matrix)
this function tries to drop the fewest possible number of variables
to return a (square, symmetric) matrix with no missing cells.</p>
    </div>

    <pre class="usage"><span class='fu'>corOK</span>(<span class='no'>x</span>, <span class='kw'>maxiter</span> <span class='kw'>=</span> <span class='fl'>100</span>)</pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>x</th>
      <td><p>a square, symmetric matrix or object coercable to such (such as a data frame).</p></td>
    </tr>
    <tr>
      <th>maxiter</th>
      <td><p>a number indicating the maximum number of iterations,
currently as a sanity check. See details.</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>A list with two elements</p>
<dt>x</dt><dd><p>The complete non missing matrix.</p></dd>
  <dt>keep.indices</dt><dd><p>A vector of the columns and rows from the
    original matrix to be kept (i.e., that are nonmissing).</p></dd>

    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>The assumption that x is square and symmetric comes because it is
assumed that the number of missing cells for a given column are identical
to that of the corresponding row.  <code>corOK</code> finds the column with the
most missing values, and drops that (and its corresponding row), and continues
on in like manner until the matrix has no missing values.  Although this was
intended for a correlation matrix, it could be used on other types of matrices.
Note that because <code>corOK</code> uses an iterative method, it can be slow when many
columns/rows need to be removed. For the intended use (correlation matrices) there
probably should not be many missing.  As a sanity check and to prevent tediously long
computations, the maximum number of iterations can be set.</p>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='no'>cormat</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/stats/cor.html'>cor</a></span>(<span class='no'>iris</span>[, -<span class='fl'>5</span>])
<span class='co'># set missing</span>
<span class='no'>cormat</span>[<span class='fu'><a href='https://rdrr.io/r/base/cbind.html'>cbind</a></span>(<span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='fl'>1</span>,<span class='fl'>2</span>), <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='fl'>2</span>,<span class='fl'>1</span>))] <span class='kw'>&lt;-</span> <span class='fl'>NA</span>

<span class='co'># print</span>
<span class='no'>cormat</span></div><div class='output co'>#&gt;              Sepal.Length Sepal.Width Petal.Length Petal.Width
#&gt; Sepal.Length    1.0000000          NA    0.8717538   0.8179411
#&gt; Sepal.Width            NA   1.0000000   -0.4284401  -0.3661259
#&gt; Petal.Length    0.8717538  -0.4284401    1.0000000   0.9628654
#&gt; Petal.Width     0.8179411  -0.3661259    0.9628654   1.0000000</div><div class='input'>
<span class='co'># return complete</span>
<span class='fu'>corOK</span>(<span class='no'>cormat</span>)</div><div class='output co'>#&gt; $x
#&gt;              Sepal.Width Petal.Length Petal.Width
#&gt; Sepal.Width    1.0000000   -0.4284401  -0.3661259
#&gt; Petal.Length  -0.4284401    1.0000000   0.9628654
#&gt; Petal.Width   -0.3661259    0.9628654   1.0000000
#&gt; 
#&gt; $keep.indices
#&gt; [1] 2 3 4
#&gt; </div><div class='input'>
<span class='co'># using maximum iterations</span>
<span class='fu'>corOK</span>(<span class='no'>cormat</span>, <span class='kw'>maxiter</span><span class='kw'>=</span><span class='fl'>0</span>)</div><div class='output co'>#&gt; <span class='warning'>Warning: Maximum iterations exceeded.</span>
#&gt; <span class='warning'>Currently kept indices will be returned.</span>
#&gt; <span class='warning'>Try increasing maxiter or check why so many correlations are missing.</span></div><div class='output co'>#&gt; [1] 1 2 3 4</div><div class='input'>
<span class='co'># clean up</span>
<span class='fu'><a href='https://rdrr.io/r/base/rm.html'>rm</a></span>(<span class='no'>cormat</span>)</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Joshua F. Wiley.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.5.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


