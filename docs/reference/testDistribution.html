<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Test the distribution of a variable against a specific distribution — testDistribution • JWileymisc</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script>
<!-- Bootstrap -->
<link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/flatly/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous" />


<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/all.min.css" integrity="sha256-nAmazAk6vS34Xqo0BSrTb+abbtFlgsFK7NKSi6o7Y78=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/v4-shims.min.css" integrity="sha256-6qHlizsOWFskGlwVOKuns+D1nB6ssZrHQrNj1wGplHc=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/headroom.min.js" integrity="sha256-DJFC1kqIhelURkuza0AvYal5RxMtpzLjFhsnVIeuk+U=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Test the distribution of a variable against a specific distribution — testDistribution" />
<meta property="og:description" content="Function designed to help examine distributions.
It also includes an option for assessing multivariate normality using the
(squared) Mahalanobis distance. A generic function, some methods, and
constructor (as.testDistribution) and function to check class
(is.testDistribution) also are provided.
Note that for the use argument, several options are possible.
By default it is &amp;#8220;complete.obs&amp;#8221;, which uses only cases with complete
data on all variables.
Another option is &amp;#8220;pairwise.complete.obs&amp;#8221;, which uses
all available data for each variable indivdiually to estimate the means and
variances, and all pairwise complete observation pairs for each covariance. Because
the same cases are not used for all estimates, it is possible to obtain a covariance
matrix that is not positive definite (e.g., correlations &amp;gt; +1 or &amp;lt; -1).
Finally, the last option is &amp;#8220;fiml&amp;#8221;, which uses full information maximum likelihood
estimates of the means and covariance matrix.  Depending on the number of cases,
missing data patterns, and variables, this may be quite slow and computationally
demanding.
The robust argument determines whether to use robust estimates or not
when calculating densities, etc.  By default it is FALSE, but if
TRUE and a univariate or multivariate normal distribution is tested,
then robust estimates of the means and covariance matrix (a variance if univariate)
will be used based on covMcd from the robustbase package." />
<meta name="twitter:card" content="summary" />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body>
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">JWileymisc</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">1.0.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/diagnostics-vignette.html">Diagnostics</a>
    </li>
    <li>
      <a href="../articles/exploratory-vignette.html">Exploratory and Descriptive Statistics and Plots</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/JWiley/JWileymisc">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Test the distribution of a variable against a specific distribution</h1>
    <small class="dont-index">Source: <a href='https://github.com/JWiley/JWileymisc/blob/master/R/diagnostics.R'><code>R/diagnostics.R</code></a></small>
    <div class="hidden name"><code>testDistribution.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Function designed to help examine distributions.
It also includes an option for assessing multivariate normality using the
(squared) Mahalanobis distance. A generic function, some methods, and
constructor (<code>as.testDistribution</code>) and function to check class
(<code>is.testDistribution</code>) also are provided.</p>
<p>Note that for the <code>use</code> argument, several options are possible.
By default it is &#8220;complete.obs&#8221;, which uses only cases with complete
data on all variables.
Another option is &#8220;pairwise.complete.obs&#8221;, which uses
all available data for each variable indivdiually to estimate the means and
variances, and all pairwise complete observation pairs for each covariance. Because
the same cases are not used for all estimates, it is possible to obtain a covariance
matrix that is not positive definite (e.g., correlations &gt; +1 or &lt; -1).</p>
<p>Finally, the last option is &#8220;fiml&#8221;, which uses full information maximum likelihood
estimates of the means and covariance matrix.  Depending on the number of cases,
missing data patterns, and variables, this may be quite slow and computationally
demanding.</p>
<p>The <code>robust</code> argument determines whether to use robust estimates or not
when calculating densities, etc.  By default it is <code>FALSE</code>, but if
<code>TRUE</code> and a univariate or multivariate normal distribution is tested,
then robust estimates of the means and covariance matrix (a variance if univariate)
will be used based on <code>covMcd</code> from the <span class="pkg">robustbase</span> package.</p>
    </div>

    <pre class="usage"><span class='fu'>testDistribution</span>(<span class='no'>x</span>, <span class='no'>...</span>)

<span class='fu'>as.testDistribution</span>(<span class='no'>x</span>)

<span class='fu'>is.testDistribution</span>(<span class='no'>x</span>)

<span class='co'># S3 method for default</span>
<span class='fu'>testDistribution</span>(<span class='no'>x</span>, <span class='kw'>distr</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='st'>"normal"</span>, <span class='st'>"beta"</span>,
  <span class='st'>"chisq"</span>, <span class='st'>"f"</span>, <span class='st'>"gamma"</span>, <span class='st'>"nbinom"</span>, <span class='st'>"poisson"</span>, <span class='st'>"mvnormal"</span>), <span class='kw'>na.rm</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>,
  <span class='no'>starts</span>, <span class='kw'>extremevalues</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='st'>"no"</span>, <span class='st'>"theoretical"</span>, <span class='st'>"empirical"</span>),
  <span class='kw'>ev.perc</span> <span class='kw'>=</span> <span class='fl'>0.005</span>, <span class='kw'>use</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='st'>"complete.obs"</span>, <span class='st'>"pairwise.complete.obs"</span>,
  <span class='st'>"fiml"</span>), <span class='kw'>robust</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>, <span class='no'>...</span>)</pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>x</th>
      <td><p>The data as a single variable or vector to check the distribution unless
the distribution is &#8220;mvnormal&#8221; in which case it should be a data frame or
data table.</p></td>
    </tr>
    <tr>
      <th>...</th>
      <td><p>Additional arguments. If these include mu and sigma and the distribution
is multivariate normal, then it will use the passed values instead of calculating
the mean and covariances of the data.</p></td>
    </tr>
    <tr>
      <th>distr</th>
      <td><p>A character string indicating the distribution to be tested.
Currently one of: &#8220;normal&#8221;, &#8220;beta&#8221;, &#8220;chisq&#8221; (chi-squared),
&#8220;f&#8221;, &#8220;gamma&#8221;, &#8220;nbinom&#8221; (negative binomial),
&#8220;poisson&#8221;, or &#8220;mvnormal&#8221; for multivariate normal where Mahalanobis
distances are calculated and compared against a Chi-squared distribution with
degrees of freedom equal to the number of variables.</p></td>
    </tr>
    <tr>
      <th>na.rm</th>
      <td><p>A logical value whether to omit missing values. Defaults to <code>TRUE</code>.</p></td>
    </tr>
    <tr>
      <th>starts</th>
      <td><p>A named list of the starting values. Not required for all distributions.
Passed on to <code>fitdistr</code> which fits the maximum likelihood estimates of the
distribution parameters.</p></td>
    </tr>
    <tr>
      <th>extremevalues</th>
      <td><p>A character vector whether to indicate extreme values.
Should be &#8220;no&#8221; to do nothing, &#8220;empirical&#8221; to show extreme
values based on the observed data percentiles, or &#8220;theoretical&#8221;
to show extreme values based on percentiles of the theoretical distribution.</p></td>
    </tr>
    <tr>
      <th>ev.perc</th>
      <td><p>Percentile to use for extreme values.  For example if .01,
then the lowest 1 percent and highest 1 percent will be labelled
extreme values.  Defaults to the lowest and highest 0.5 percent.</p></td>
    </tr>
    <tr>
      <th>use</th>
      <td><p>A character vector indicating how the moments
(means and covariance matrix) should be estimated in the presence of
missing data when <code>distr = mvnormal</code>.
The default is to use complete observations, but
full information maximum likelihood based on functions in
<span class="pkg">lavaan</span> is also available.  See details.</p></td>
    </tr>
    <tr>
      <th>robust</th>
      <td><p>A logical whether to use robust estimation or not.
Currently only applies to normally distributed data
(univariate or multivariate).  Also, when <code>robust = TRUE</code>,
only complete observations are used (i.e., <code>use = "complete.obs"</code>).
See details.</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>A logical whether or not an object is of class
  <code>testDistribution</code> or an object of the same class.</p>
<p>A list with information about the distribution (parameter estimates,
  name, log likelihood (useful for comparing the fit of different distributions
  to the data), and a dataset with the sorted data and theoretical quantiles.</p>
    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <div class='dont-index'><p><code><a href='SEMSummary.html'>SEMSummary</a></code></p></div>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'>
<span class='kw'>if</span> (<span class='fl'>FALSE</span>) {

<span class='co'>## example data</span>
<span class='fu'><a href='https://rdrr.io/r/base/Random.html'>set.seed</a></span>(<span class='fl'>1234</span>)
<span class='no'>d</span> <span class='kw'>&lt;-</span> <span class='kw pkg'>data.table</span><span class='kw ns'>::</span><span class='fu'><a href='https://rdrr.io/pkg/data.table/man/data.table.html'>data.table</a></span>(
  <span class='kw'>Ynorm</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/stats/Normal.html'>rnorm</a></span>(<span class='fl'>200</span>),
  <span class='kw'>Ybeta</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/stats/Beta.html'>rbeta</a></span>(<span class='fl'>200</span>, <span class='fl'>1</span>, <span class='fl'>4</span>),
  <span class='kw'>Ychisq</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/stats/Chisquare.html'>rchisq</a></span>(<span class='fl'>200</span>, <span class='fl'>8</span>),
  <span class='kw'>Yf</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/stats/Fdist.html'>rf</a></span>(<span class='fl'>200</span>, <span class='fl'>5</span>, <span class='fl'>10</span>),
  <span class='kw'>Ygamma</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/stats/GammaDist.html'>rgamma</a></span>(<span class='fl'>200</span>, <span class='fl'>2</span>, <span class='fl'>2</span>),
  <span class='kw'>Ynbinom</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/stats/NegBinomial.html'>rnbinom</a></span>(<span class='fl'>200</span>, <span class='kw'>mu</span> <span class='kw'>=</span> <span class='fl'>4</span>, <span class='kw'>size</span> <span class='kw'>=</span> <span class='fl'>9</span>),
  <span class='kw'>Ypois</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/stats/Poisson.html'>rpois</a></span>(<span class='fl'>200</span>, <span class='fl'>4</span>))

<span class='co'>## testing and graphing</span>
<span class='fu'>testDistribution</span>(<span class='no'>d</span>$<span class='no'>Ybeta</span>, <span class='st'>"beta"</span>, <span class='kw'>starts</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span>(<span class='kw'>shape1</span> <span class='kw'>=</span> <span class='fl'>1</span>, <span class='kw'>shape2</span> <span class='kw'>=</span> <span class='fl'>4</span>))
<span class='fu'>testDistribution</span>(<span class='no'>d</span>$<span class='no'>Ychisq</span>, <span class='st'>"chisq"</span>, <span class='kw'>starts</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span>(<span class='kw'>df</span> <span class='kw'>=</span> <span class='fl'>8</span>))

<span class='co'>## for chi-square distribution, extreme values only on</span>
<span class='co'>## the right tail</span>
<span class='fu'>testDistribution</span>(<span class='no'>d</span>$<span class='no'>Ychisq</span>, <span class='st'>"chisq"</span>, <span class='kw'>starts</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span>(<span class='kw'>df</span> <span class='kw'>=</span> <span class='fl'>8</span>),
  <span class='kw'>extremevalues</span> <span class='kw'>=</span> <span class='st'>"empirical"</span>, <span class='kw'>ev.perc</span> <span class='kw'>=</span> <span class='fl'>.1</span>)
<span class='fu'>testDistribution</span>(<span class='no'>d</span>$<span class='no'>Ychisq</span>, <span class='st'>"chisq"</span>, <span class='kw'>starts</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span>(<span class='kw'>df</span> <span class='kw'>=</span> <span class='fl'>8</span>),
  <span class='kw'>extremevalues</span> <span class='kw'>=</span> <span class='st'>"theoretical"</span>, <span class='kw'>ev.perc</span> <span class='kw'>=</span> <span class='fl'>.1</span>)

<span class='fu'>testDistribution</span>(<span class='no'>d</span>$<span class='no'>Yf</span>, <span class='st'>"f"</span>, <span class='kw'>starts</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span>(<span class='kw'>df1</span> <span class='kw'>=</span> <span class='fl'>5</span>, <span class='kw'>df2</span> <span class='kw'>=</span> <span class='fl'>10</span>))
<span class='fu'>testDistribution</span>(<span class='no'>d</span>$<span class='no'>Ygamma</span>, <span class='st'>"gamma"</span>)
<span class='fu'>testDistribution</span>(<span class='no'>d</span>$<span class='no'>Ynbinom</span>, <span class='st'>"poisson"</span>)
<span class='fu'>testDistribution</span>(<span class='no'>d</span>$<span class='no'>Ynbinom</span>, <span class='st'>"nbinom"</span>)
<span class='fu'>testDistribution</span>(<span class='no'>d</span>$<span class='no'>Ypois</span>, <span class='st'>"poisson"</span>)

<span class='co'>## compare log likelihood of two different distributions</span>
<span class='fu'>testDistribution</span>(<span class='no'>d</span>$<span class='no'>Ygamma</span>, <span class='st'>"normal"</span>)$<span class='no'>Distribution</span>$<span class='no'>LL</span>
<span class='fu'>testDistribution</span>(<span class='no'>d</span>$<span class='no'>Ygamma</span>, <span class='st'>"gamma"</span>)$<span class='no'>Distribution</span>$<span class='no'>LL</span>

<span class='fu'>testDistribution</span>(<span class='no'>d</span>$<span class='no'>Ynorm</span>, <span class='st'>"normal"</span>)
<span class='fu'>testDistribution</span>(<span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='no'>d</span>$<span class='no'>Ynorm</span>, <span class='fl'>10</span>, <span class='fl'>1000</span>), <span class='st'>"normal"</span>,
  <span class='kw'>extremevalues</span> <span class='kw'>=</span> <span class='st'>"theoretical"</span>)
<span class='fu'>testDistribution</span>(<span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='no'>d</span>$<span class='no'>Ynorm</span>, <span class='fl'>10</span>, <span class='fl'>1000</span>), <span class='st'>"normal"</span>,
  <span class='kw'>extremevalues</span> <span class='kw'>=</span> <span class='st'>"theoretical"</span>, <span class='kw'>robust</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>)

<span class='fu'>testDistribution</span>(<span class='no'>mtcars</span>, <span class='st'>"mvnormal"</span>)

<span class='co'>## for multivariate normal mahalanobis distance</span>
<span class='co'>## which follows a chi-square distribution, extreme values only on</span>
<span class='co'>## the right tail</span>
<span class='fu'>testDistribution</span>(<span class='no'>mtcars</span>, <span class='st'>"mvnormal"</span>, <span class='kw'>extremevalues</span> <span class='kw'>=</span> <span class='st'>"empirical"</span>,
  <span class='kw'>ev.perc</span> <span class='kw'>=</span> <span class='fl'>.1</span>)
<span class='fu'>testDistribution</span>(<span class='no'>mtcars</span>, <span class='st'>"mvnormal"</span>, <span class='kw'>extremevalues</span> <span class='kw'>=</span> <span class='st'>"theoretical"</span>,
  <span class='kw'>ev.perc</span> <span class='kw'>=</span> <span class='fl'>.1</span>)

<span class='fu'><a href='https://rdrr.io/r/base/rm.html'>rm</a></span>(<span class='no'>d</span>) <span class='co'>## cleanup</span>
}</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
    <h2>Contents</h2>
    <ul class="nav nav-pills nav-stacked">
      <li><a href="#arguments">Arguments</a></li>
      <li><a href="#value">Value</a></li>
      <li><a href="#see-also">See also</a></li>
      <li><a href="#examples">Examples</a></li>
    </ul>

  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Joshua F. Wiley.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.4.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


