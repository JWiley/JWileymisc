<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Heatmap of a Correlation Matrix — corplot • JWileymisc</title><script src="../lightswitch.js"></script><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><script src="../deps/MathJax-3.2.2/tex-chtml.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Heatmap of a Correlation Matrix — corplot"><meta name="description" content="This function creates a heatmap of a correlation matrix using ggplot2."><meta property="og:description" content="This function creates a heatmap of a correlation matrix using ggplot2."><meta name="twitter:card" content="summary"><meta name="twitter:creator" content="@WileyResearch"><meta name="twitter:site" content="https://joshuawiley.com"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top " aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">JWileymisc</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.4.3</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/diagnostics-vignette.html">Diagnostics</a></li>
    <li><a class="dropdown-item" href="../articles/exploratory-vignette.html">Exploratory and Descriptive Statistics and Plots</a></li>
    <li><a class="dropdown-item" href="../articles/model-test-vignette.html">Model Performance and Tests</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/JWiley/JWileymisc/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-lightswitch" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true" aria-label="Light switch"><span class="fa fa-sun"></span></button>
  <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="dropdown-lightswitch"><li><button class="dropdown-item" data-bs-theme-value="light"><span class="fa fa-sun"></span> Light</button></li>
    <li><button class="dropdown-item" data-bs-theme-value="dark"><span class="fa fa-moon"></span> Dark</button></li>
    <li><button class="dropdown-item" data-bs-theme-value="auto"><span class="fa fa-adjust"></span> Auto</button></li>
  </ul></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Heatmap of a Correlation Matrix</h1>
      <small class="dont-index">Source: <a href="https://github.com/JWiley/JWileymisc/blob/main/R/plotting.R" class="external-link"><code>R/plotting.R</code></a></small>
      <div class="d-none name"><code>corplot.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>This function creates a heatmap of a correlation matrix using <span class="pkg">ggplot2</span>.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">corplot</span><span class="op">(</span></span>
<span>  <span class="va">x</span>,</span>
<span>  <span class="va">coverage</span>,</span>
<span>  <span class="va">pvalues</span>,</span>
<span>  type <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"both"</span>, <span class="st">"cor"</span>, <span class="st">"p"</span>, <span class="st">"coverage"</span><span class="op">)</span>,</span>
<span>  digits <span class="op">=</span> <span class="fl">2</span>,</span>
<span>  order <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"cluster"</span>, <span class="st">"asis"</span><span class="op">)</span>,</span>
<span>  <span class="va">...</span>,</span>
<span>  control.grobs <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-x">x<a class="anchor" aria-label="anchor" href="#arg-x"></a></dt>
<dd><p>A correlation matrix or some other square symmetric matrix.</p></dd>


<dt id="arg-coverage">coverage<a class="anchor" aria-label="anchor" href="#arg-coverage"></a></dt>
<dd><p>An (optional) matrix with the same dimensions as
<code>x</code> giving the proportion of data present.  Particularly
useful when the correlation matrix is a pairwise present.</p></dd>


<dt id="arg-pvalues">pvalues<a class="anchor" aria-label="anchor" href="#arg-pvalues"></a></dt>
<dd><p>An (optional) matrix with the same dimensions as
<code>x</code> giving the p values for each correlation. To show, use
<code>plot = "p"</code>.</p></dd>


<dt id="arg-type">type<a class="anchor" aria-label="anchor" href="#arg-type"></a></dt>
<dd><p>A character string indicating what to show on top of the heatmap. Can be
‘coverage’, in which case bubble points show coverage;
‘p’, in which case p values are shown;
‘cor’, in which case correlations are shown; or
‘both’, in which case both correlations and p-values are shown.
Only has an effect if a coverage (or pvalue) matrix is passed
also. Defaults to <code>cor</code>.</p></dd>


<dt id="arg-digits">digits<a class="anchor" aria-label="anchor" href="#arg-digits"></a></dt>
<dd><p>The number of digits to round to when printing the
correlations on the heatmap. Text is suppressed when a coverage
matrix is passed and <code>points = TRUE</code>.</p></dd>


<dt id="arg-order">order<a class="anchor" aria-label="anchor" href="#arg-order"></a></dt>
<dd><p>A character string indicating how to order the resulting
plot. Defaults to ‘cluster’ which uses hierarchical clustering
to sensibly order the variables. The other option is ‘asis’
in which case the matrix is plotted in the order it is passed.</p></dd>


<dt id="arg--">...<a class="anchor" aria-label="anchor" href="#arg--"></a></dt>
<dd><p>Additional arguments currently only passed to
<code>hclust</code> and <code>corOK</code>.</p></dd>


<dt id="arg-control-grobs">control.grobs<a class="anchor" aria-label="anchor" href="#arg-control-grobs"></a></dt>
<dd><p>A list of additional <code><a href="https://rdrr.io/r/base/substitute.html" class="external-link">quote()</a></code>d
options to customize the <code>ggplot2</code> output.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>Primarily called for the side effect of creating a plot.
  However, the <code>ggplot2</code> plot object is returned,
  so it can be saved, replotted, edited, etc.</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>The actual plot is created using <code>ggplot2</code> and <code>geom_tile</code>.
In addition to creating the plot, the variables are ordered based on a
hierarchical clustering of the correlation matrix.  Specifically, <code>1 - x</code>
is used as the distance matrix. If coverage is passed, will also add a bubble
plot with the area proportional to the proportion of data present for any
given cell.  Defaults for <code>ggplot2</code> are set, but it is possible to use a
named list of quote()d ggplot calls to override all defaults. This is not
expected for typical use.  Particularly main, points, and text as these rely
on internal variable names; however, labels, the gradient color, and area
scaling can be adjusted more safely.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co"># example plotting the correlation matrix from the</span></span></span>
<span class="r-in"><span><span class="co"># mtcars dataset</span></span></span>
<span class="r-in"><span><span class="fu">corplot</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/cor.html" class="external-link">cor</a></span><span class="op">(</span><span class="va">mtcars</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="corplot-1.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">dat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">as.matrix</a></span><span class="op">(</span><span class="va">iris</span><span class="op">[</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">4</span><span class="op">]</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># randomly set 25% of the data to missing</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">10</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">dat</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">dat</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">dat</span><span class="op">)</span> <span class="op">*</span> <span class="fl">.25</span><span class="op">)</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="cn">NA</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/stats/cor.html" class="external-link">cor</a></span><span class="op">(</span><span class="va">dat</span>, use <span class="op">=</span> <span class="st">"pair"</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>              Sepal.Length Sepal.Width Petal.Length Petal.Width</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Sepal.Length    1.0000000  -0.1541181    0.8643051   0.8308327</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Sepal.Width    -0.1541181   1.0000000   -0.4433845  -0.4247681</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Petal.Length    0.8643051  -0.4433845    1.0000000   0.9648311</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Petal.Width     0.8308327  -0.4247681    0.9648311   1.0000000</span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/stats/cor.html" class="external-link">cor</a></span><span class="op">(</span><span class="va">dat</span>, use <span class="op">=</span> <span class="st">"complete"</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>              Sepal.Length Sepal.Width Petal.Length Petal.Width</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Sepal.Length    1.0000000  -0.1307569    0.8570142   0.8191163</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Sepal.Width    -0.1307569   1.0000000   -0.4938995  -0.4366410</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Petal.Length    0.8570142  -0.4938995    1.0000000   0.9722523</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Petal.Width     0.8191163  -0.4366410    0.9722523   1.0000000</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># create a summary of the data (including coverage matrix)</span></span></span>
<span class="r-in"><span><span class="va">sdat</span> <span class="op">&lt;-</span> <span class="fu"><a href="SEMSummary.html">SEMSummary</a></span><span class="op">(</span><span class="op">~</span> <span class="va">.</span>, data <span class="op">=</span> <span class="va">dat</span>, use <span class="op">=</span> <span class="st">"pair"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/str.html" class="external-link">str</a></span><span class="op">(</span><span class="va">sdat</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> List of 9</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  $ names   : chr [1:4] "Sepal.Length" "Sepal.Width" "Petal.Length" "Petal.Width"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  $ n       : int 150</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  $ nmissing: Named num [1:4] 36 36 43 35</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   ..- attr(*, "names")= chr [1:4] "Sepal.Length" "Sepal.Width" "Petal.Length" "Petal.Width"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  $ mu      : Named num [1:4] 5.88 3.09 3.81 1.21</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   ..- attr(*, "names")= chr [1:4] "Sepal.Length" "Sepal.Width" "Petal.Length" "Petal.Width"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  $ stdev   : Named num [1:4] 0.833 0.442 1.753 0.754</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   ..- attr(*, "names")= chr [1:4] "Sepal.Length" "Sepal.Width" "Petal.Length" "Petal.Width"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  $ Sigma   : num [1:4, 1:4] 0.6941 -0.0584 1.2961 0.5134 -0.0584 ...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   ..- attr(*, "dimnames")=List of 2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   .. ..$ : chr [1:4] "Sepal.Length" "Sepal.Width" "Petal.Length" "Petal.Width"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   .. ..$ : chr [1:4] "Sepal.Length" "Sepal.Width" "Petal.Length" "Petal.Width"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  $ sSigma  : num [1:4, 1:4] 1 -0.154 0.864 0.831 -0.154 ...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   ..- attr(*, "dimnames")=List of 2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   .. ..$ : chr [1:4] "Sepal.Length" "Sepal.Width" "Petal.Length" "Petal.Width"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   .. ..$ : chr [1:4] "Sepal.Length" "Sepal.Width" "Petal.Length" "Petal.Width"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  $ coverage: num [1:4, 1:4] 0.76 0.567 0.54 0.567 0.567 ...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   ..- attr(*, "dimnames")=List of 2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   .. ..$ : chr [1:4] "Sepal.Length" "Sepal.Width" "Petal.Length" "Petal.Width"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   .. ..$ : chr [1:4] "Sepal.Length" "Sepal.Width" "Petal.Length" "Petal.Width"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  $ pvalue  : num [1:4, 1:4] NA 0.159 0 0 0.159 ...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   ..- attr(*, "dimnames")=List of 2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   .. ..$ : chr [1:4] "Sepal.Length" "Sepal.Width" "Petal.Length" "Petal.Width"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   .. ..$ : chr [1:4] "Sepal.Length" "Sepal.Width" "Petal.Length" "Petal.Width"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  - attr(*, "class")= chr "SEMSummary"</span>
<span class="r-in"><span><span class="co"># using the plot method for SEMSummary (which basically just calls corplot)</span></span></span>
<span class="r-in"><span><span class="co">## getting correlations above diagonal and p values below diagonal#'</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">sdat</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="corplot-2.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## get correlations only</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">sdat</span>, type <span class="op">=</span> <span class="st">"cor"</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="corplot-3.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## showing coverage</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">sdat</span>, type <span class="op">=</span> <span class="st">"coverage"</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="corplot-4.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># use the control.grobs argument to adjust the coverage scaling</span></span></span>
<span class="r-in"><span><span class="co"># to go from 0 to 1 rather than the range of coverage</span></span></span>
<span class="r-in"><span><span class="fu">corplot</span><span class="op">(</span>x <span class="op">=</span> <span class="va">sdat</span><span class="op">$</span><span class="va">sSigma</span>, coverage <span class="op">=</span> <span class="va">sdat</span><span class="op">$</span><span class="va">coverage</span>,</span></span>
<span class="r-in"><span>  type <span class="op">=</span> <span class="st">"coverage"</span>,</span></span>
<span class="r-in"><span>  control.grobs <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>area <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/substitute.html" class="external-link">quote</a></span><span class="op">(</span><span class="fu">scale_size_area</span><span class="op">(</span>limits <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="corplot-5.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># also works with plot() on a SEMSummary</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">sdat</span>, type <span class="op">=</span> <span class="st">"coverage"</span>,</span></span>
<span class="r-in"><span>  control.grobs <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>area <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/substitute.html" class="external-link">quote</a></span><span class="op">(</span><span class="fu">scale_size_area</span><span class="op">(</span>limits <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="corplot-6.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/rm.html" class="external-link">rm</a></span><span class="op">(</span><span class="va">dat</span>, <span class="va">sdat</span><span class="op">)</span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by <a href="https://joshuawiley.com" class="external-link">Joshua F. Wiley</a>.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer></div>





  </body></html>

