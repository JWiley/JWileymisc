<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Internal Visual Acuity Functions — vainternal • JWileymisc</title><!-- mathjax math --><script src="https://cdn.jsdelivr.net/npm/mathjax@3.2.2/es5/tex-mml-chtml.js" integrity="sha256-MASABpB4tYktI2Oitl4t+78w/lyA+D7b/s9GEP0JOGI=" crossorigin="anonymous"></script><script>
  window.MathJax = {
    chtml: {
      fontURL: "https://cdn.jsdelivr.net/npm/mathjax@3.2.2/es5/output/chtml/fonts/woff-v2"
    }
  };
</script><script src="../lightswitch.js"></script><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Internal Visual Acuity Functions — vainternal"><meta name="description" content='This function is one of several designed to help convert measures of
visual acuity recorded typically recorded as Snellen fractions
(e.g., 20/20 sees at 20 feet what is "typically" seen at 20 feet.
20/40 sees at 20 feet what is "typically" seen at 40 feet, etc.)
into statistically usable data.  It can also parse text data
for Counting Fingers (CF) and Hand Motion (HM)  and convert them to
approximate logMAR values.
This is an internal function and is not  meant to be
called directly.'><meta property="og:description" content='This function is one of several designed to help convert measures of
visual acuity recorded typically recorded as Snellen fractions
(e.g., 20/20 sees at 20 feet what is "typically" seen at 20 feet.
20/40 sees at 20 feet what is "typically" seen at 40 feet, etc.)
into statistically usable data.  It can also parse text data
for Counting Fingers (CF) and Hand Motion (HM)  and convert them to
approximate logMAR values.
This is an internal function and is not  meant to be
called directly.'><meta name="twitter:card" content="summary"><meta name="twitter:creator" content="@WileyResearch"><meta name="twitter:site" content="https://joshuawiley.com"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top " aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">JWileymisc</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.4.3</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/diagnostics-vignette.html">Diagnostics</a></li>
    <li><a class="dropdown-item" href="../articles/exploratory-vignette.html">Exploratory and Descriptive Statistics and Plots</a></li>
    <li><a class="dropdown-item" href="../articles/model-test-vignette.html">Model Performance and Tests</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/JWiley/JWileymisc/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-lightswitch" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true" aria-label="Light switch"><span class="fa fa-sun"></span></button>
  <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="dropdown-lightswitch"><li><button class="dropdown-item" data-bs-theme-value="light"><span class="fa fa-sun"></span> Light</button></li>
    <li><button class="dropdown-item" data-bs-theme-value="dark"><span class="fa fa-moon"></span> Dark</button></li>
    <li><button class="dropdown-item" data-bs-theme-value="auto"><span class="fa fa-adjust"></span> Auto</button></li>
  </ul></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Internal Visual Acuity Functions</h1>
      <small class="dont-index">Source: <a href="https://github.com/JWiley/JWileymisc/blob/main/R/visual_acuity.R" class="external-link"><code>R/visual_acuity.R</code></a></small>
      <div class="d-none name"><code>vainternal.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>This function is one of several designed to help convert measures of
visual acuity recorded typically recorded as Snellen fractions
(e.g., 20/20 sees at 20 feet what is "typically" seen at 20 feet.
20/40 sees at 20 feet what is "typically" seen at 40 feet, etc.)
into statistically usable data.  It can also parse text data
for Counting Fingers (CF) and Hand Motion (HM)  and convert them to
approximate logMAR values.
This is an internal function and is not  meant to be
called directly.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">logmar</span><span class="op">(</span><span class="va">x</span>, snell.numerator <span class="op">=</span> <span class="fl">20</span>, inverse <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">CFHM</span><span class="op">(</span><span class="va">x</span>, <span class="va">zero</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">snellen</span><span class="op">(</span><span class="va">snellenvalue</span>, <span class="va">chart.values</span>, <span class="va">chart.nletters</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-x">x<a class="anchor" aria-label="anchor" href="#arg-x"></a></dt>
<dd><p>Character data of the form: “CF 10”, “HM 12”,
“HM”, “CF”, “CF 2”, etc. to be converted to
logMAR values.</p></dd>


<dt id="arg-snell-numerator">snell.numerator<a class="anchor" aria-label="anchor" href="#arg-snell-numerator"></a></dt>
<dd><p>The numerator of a Snellen fraction.
It defaults to 20 (the most common one).</p></dd>


<dt id="arg-inverse">inverse<a class="anchor" aria-label="anchor" href="#arg-inverse"></a></dt>
<dd><p><code>inverse</code> = FALSE by default.  If TRUE,
<code>logmar</code> will assume <code>x</code> is a logMAR value, and
calculate the denominator of a Snellen fraction using the
<code>snell.numerator</code> as the numerator.</p></dd>


<dt id="arg-zero">zero<a class="anchor" aria-label="anchor" href="#arg-zero"></a></dt>
<dd><p>A “zero” logMAR value to be used for any CF or HM
value missing a number.  May be an actual number or simply <code>NA</code></p></dd>


<dt id="arg-snellenvalue">snellenvalue<a class="anchor" aria-label="anchor" href="#arg-snellenvalue"></a></dt>
<dd><p>The observed snellen values</p></dd>


<dt id="arg-chart-values">chart.values<a class="anchor" aria-label="anchor" href="#arg-chart-values"></a></dt>
<dd><p>The chart snellen values</p></dd>


<dt id="arg-chart-nletters">chart.nletters<a class="anchor" aria-label="anchor" href="#arg-chart-nletters"></a></dt>
<dd><p>The number of letters per chart line</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>This treats CF as approximately 200 letters (per Holladay), so
CF at 10 feet has Snellen value "equivalent" of 10/200. HM is
approximately 10 times worse, so HM at 10 feet approximately
10/2000.  After conversion, rough equivalents are passed to
<code>logmar</code> to actually be converted.
Other functions are responsible for suitably parsing the text and
passing numbers to <code>logmar</code>. If <code>inverse = FALSE</code> (the default),
<code>logmar</code> calculates \(-log_{10}(\frac{snell.numerator}{x})\).
If <code>TRUE</code>, then \(\frac{snell.numerator}{10^{-x}}\).</p>
<p>The <code>zero</code> argument is used to specify a "zero" logMAR value.
In particular, this is used when no distance information is given
(e.g., only "HM" or "CF" as opposed to "CF 6" or "HM 4").
For the reasioning and rational behind this, see the "Details"
section of <code><a href="VAConverter.html">VAConverter</a></code>.</p>
<p>For the <code>snellen</code> function, the input should be character data
and have a numerator and denominator separated by '/'.  E.g.,
“20/20”, “20/40 + 3”.  This handles both simple
and Snellen values that need to be interpolated given the
appropriate chart.</p>
<p>logMAR calculations including interpolating partial lines.
Given “20/25 + 3”, calculate the logMAR of 20/25 and
20/20 (the next step up since '+'), and go 3/chart.nletters
of the way between these two values.  Similarly if
“20/20 - 3”, it will go partway between 20/25 and 20/30.
Note that it depends on the lines and letters per line
<em>on the actual chart used</em>. The <code>chart.values</code> and
<code>chart.nletters</code> should contain all the lines and number
of letters for the chart that was used.</p>
<p>These functions were written to deal
with a very specific style of recording visual acuity for a study I
worked on.  It may or may not have much use elsewhere.  <code>CFHM</code>
was not intended to typically be called by the user directly.
Generally, a higher level function, (e.g., <code>VAConverter</code>) would
be called.</p>
    </div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>Jack T. Holladay (2004).  Visual acuity measurements.
  <em>Journal of Cataract &amp; Refractive Surgery, 30</em>(2),
  pp. 287–290. <a href="https://doi.org/10.1016/j.jcrs.2004.01.014" class="external-link">doi:10.1016/j.jcrs.2004.01.014</a></p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><code><a href="VAConverter.html">VAConverter</a></code> the overall function typically
  called</p></div>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co">## logMAR value for "perfect" 20/20 vision</span></span></span>
<span class="r-in"><span><span class="fu">JWileymisc</span><span class="fu">:::</span><span class="fu">logmar</span><span class="op">(</span>x <span class="op">=</span> <span class="fl">20</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Go to and from logMAR value, should return "20"</span></span></span>
<span class="r-in"><span><span class="co">## there may be slight error due to floating point arithmetic</span></span></span>
<span class="r-in"><span><span class="fu">JWileymisc</span><span class="fu">:::</span><span class="fu">logmar</span><span class="op">(</span>x <span class="op">=</span> <span class="fu">JWileymisc</span><span class="fu">:::</span><span class="fu">logmar</span><span class="op">(</span>x <span class="op">=</span> <span class="fl">20</span><span class="op">)</span>, inverse <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 20</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## logMAR value for 20/40 vision</span></span></span>
<span class="r-in"><span><span class="fu">JWileymisc</span><span class="fu">:::</span><span class="fu">logmar</span><span class="op">(</span><span class="fl">40</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0.30103</span>
<span class="r-in"><span><span class="co">## logMAR approximations, note "HM" is just the zero value</span></span></span>
<span class="r-in"><span><span class="fu">JWileymisc</span><span class="fu">:::</span><span class="fu">CFHM</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"HM 20"</span>, <span class="st">"HM"</span>, <span class="st">"CF 20"</span>, <span class="st">"CF 12"</span>, <span class="st">"CF"</span><span class="op">)</span>, zero <span class="op">=</span> <span class="fl">3</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 2.000000 3.000000 1.000000 1.221849 3.000000</span>
<span class="r-in"><span><span class="co">## In cases where there is insufficient data, rather than choose</span></span></span>
<span class="r-in"><span><span class="co">## an arbitrary value, you can may just use NA</span></span></span>
<span class="r-in"><span><span class="fu">JWileymisc</span><span class="fu">:::</span><span class="fu">CFHM</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"HM 20"</span>, <span class="st">"HM"</span>, <span class="st">"CF 20"</span>, <span class="st">"CF 12"</span>, <span class="st">"CF"</span><span class="op">)</span>, zero <span class="op">=</span> <span class="cn">NA</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 2.000000       NA 1.000000 1.221849       NA</span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by <a href="https://joshuawiley.com" class="external-link">Joshua F. Wiley</a>.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer></div>





  </body></html>

